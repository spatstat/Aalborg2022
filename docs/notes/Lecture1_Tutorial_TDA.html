<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.28">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Topological Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Lecture1_Tutorial_TDA_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lecture1_Tutorial_TDA_files/libs/quarto-html/quarto.js"></script>
<script src="Lecture1_Tutorial_TDA_files/libs/quarto-html/popper.min.js"></script>
<script src="Lecture1_Tutorial_TDA_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lecture1_Tutorial_TDA_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lecture1_Tutorial_TDA_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lecture1_Tutorial_TDA_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lecture1_Tutorial_TDA_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lecture1_Tutorial_TDA_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lecture1_Tutorial_TDA_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Topological Data Analysis</h1>
<p class="subtitle lead">Application in Spatial Statistics</p>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="necessary-packages" class="level1">
<h1>Necessary Packages</h1>
<p>This is the main and standard library for Topological Data Analysis in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TDA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The R-package TDA is actually a wrapper of several standard Python/C++ libraries: Gudhi, Dionysus and PHAT.</p>
</section>
<section id="a-toy-example" class="level1">
<h1>A Toy Example</h1>
<section id="data-generation" class="level2">
<h2 class="anchored" data-anchor-id="data-generation">Data generation</h2>
<ul>
<li>Let’s use a very simple point pattern.</li>
<li>There is not need for spatstat there but let’s use it for training purposes.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.geom</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.geom 2.4-0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.random</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.random 2.2-0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.core</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: rpart</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.core 2.4-4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spatstat.linnet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>spatstat.linnet 2.3-2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
spatstat 2.3-4       (nickname: 'Watch this space') 
For an introduction to spatstat, type 'beginner' </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spatstat.options</span>(<span class="at">transparent=</span>F) <span class="co"># needed for rendering the html file. Remove transparency in plot of ppp object.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>PPtoy <span class="ot">&lt;-</span> <span class="fu">ppp</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>), </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">window=</span><span class="fu">owin</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A simple plot of these 4 points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(PPtoy, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="filtration-with-rips-complexes" class="level2">
<h2 class="anchored" data-anchor-id="filtration-with-rips-complexes">Filtration with Rips complexes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Rfiltration <span class="ot">&lt;-</span> <span class="fu">ripsFiltration</span>(<span class="at">X=</span><span class="fu">cbind</span>(PPtoy<span class="sc">$</span>x, PPtoy<span class="sc">$</span>y), </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">maxdimension=</span><span class="dv">4</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">maxscale=</span><span class="dv">3</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dist =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">library =</span> <span class="st">"GUDHI"</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">printProgress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A view on the argument:</p>
<ul>
<li>In the TDA package, the input cannot be a point pattern (ppp object) but a matrix with on the first column, the first coordinates of the points, on the second column, the second coordinates … Thus we use <code>cbind</code>.</li>
<li><code>maxdimension</code> indicates the maximal dimension of simplices that we allowed.</li>
<li><code>maxscale</code> how far away the function should look for neighbooring points.</li>
<li><code>distance</code> the distance used (see the documentation for more info)</li>
<li><code>library</code> which library to use: gudhi, dionysys or PHAT. Except for one functionality dionysus, this does not change many things when dealing with a few thousands points.</li>
</ul>
<p>Let’s display the filtration object. The returned object is a list. It contains the following.</p>
<section id="a-list-of-complexes" class="level3">
<h3 class="anchored" data-anchor-id="a-list-of-complexes">A list of complexes</h3>
<p>A list of the simplices appearing in the filtration.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Rfiltration<span class="sc">$</span>cmplx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1

[[2]]
[1] 2

[[3]]
[1] 3

[[4]]
[1] 4

[[5]]
[1] 4 3

[[6]]
[1] 3 2

[[7]]
[1] 4 2

[[8]]
[1] 4 3 2

[[9]]
[1] 3 1

[[10]]
[1] 4 1

[[11]]
[1] 4 3 1

[[12]]
[1] 2 1

[[13]]
[1] 3 2 1

[[14]]
[1] 4 2 1

[[15]]
[1] 4 3 2 1</code></pre>
</div>
</div>
<ul>
<li>The indices represents a label for the points</li>
<li><span class="math inline">\(1\ 2\)</span> means that this is a 1-dimensional simplex: the edge with the points 1 and 2.</li>
<li><span class="math inline">\(4\ 3\ 2\)</span> means that this is a 2-dimensional simplex: the filled triangle with the points 4, 3, and 2.</li>
<li><span class="math inline">\(4\ 3\ 2\ 1\)</span> means that this is a 3-dimensional simplex: the filled tetrahedron with the points 4, 3, 2 and 1.</li>
</ul>
</section>
<section id="the-filtration-values-of-the-complexes" class="level3">
<h3 class="anchored" data-anchor-id="the-filtration-values-of-the-complexes">The filtration values of the complexes</h3>
<ul>
<li>The filtration values indicates when a simplex appears for the first time in the filtration.</li>
<li>Not always true but ease the understanding: Think of it as the value of the increasing radius of the growing cirlce.</li>
<li>This is ordered as <code>Rfiltration$cmplx</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>Rfiltration<span class="sc">$</span>values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.000000 0.000000 0.000000 0.000000 1.000000 1.118034 1.118034 1.118034
 [9] 1.300000 1.300000 1.300000 2.200000 2.200000 2.200000 2.200000</code></pre>
</div>
</div>
<ul>
<li>We see that the vertices/0-dimensional complexes appears at the filtration values 0.</li>
<li>Notice how several complexes appear at the end, when there is no more information on the structure.</li>
</ul>
</section>
<section id="other-outputs" class="level3">
<h3 class="anchored" data-anchor-id="other-outputs">Other outputs</h3>
<p>The following indicates if the filtration values are indeed increasing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Rfiltration<span class="sc">$</span>increasing  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>The following return the distance matrix of the vertices. It appears only if the argument <code>dist="euclidean"</code> is used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Rfiltration<span class="sc">$</span>coordinates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,] -1.2  0.0
[2,]  1.0  0.0
[3,]  0.0 -0.5
[4,]  0.0  0.5</code></pre>
</div>
</div>
</section>
<section id="using-the-persistence-diagram" class="level3">
<h3 class="anchored" data-anchor-id="using-the-persistence-diagram">Using the persistence diagram</h3>
<p>This is done with the function <code>ripsDiag</code>. Arguments are the same as for <code>ripsFiltration</code> up to <code>location</code>. We will come back on it later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Rdiag <span class="ot">&lt;-</span> <span class="fu">ripsDiag</span>(<span class="at">X =</span> <span class="fu">cbind</span>(PPtoy<span class="sc">$</span>x, PPtoy<span class="sc">$</span>y), </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">maxdimension=</span><span class="dv">4</span>, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">maxscale=</span><span class="dv">3</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">library =</span> <span class="fu">c</span>(<span class="st">"GUDHI"</span>), </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">location =</span> F, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">printProgress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Rdiag</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$diagram
     dimension Birth    Death
[1,]         0     0 3.000000
[2,]         0     0 1.300000
[3,]         0     0 1.118034
[4,]         0     0 1.000000</code></pre>
</div>
</div>
<p><strong>Warning:</strong> The output is not directly the diagram but a list containing the diagram.</p>
<p>Let’s plot it. Note that there is no loop.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Rdiag<span class="sc">$</span>diagram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The barcode is obtained by adding one argument to the plot function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Rdiag<span class="sc">$</span>diagram, <span class="at">barcode=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="another-filtration-the-alpha-complexes" class="level2">
<h2 class="anchored" data-anchor-id="another-filtration-the-alpha-complexes">Another filtration – The <span class="math inline">\(\alpha\)</span>-complexes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Afiltration <span class="ot">&lt;-</span> <span class="fu">alphaComplexFiltration</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">X=</span><span class="fu">cbind</span>(PPtoy<span class="sc">$</span>x, PPtoy<span class="sc">$</span>y), </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">library =</span> <span class="st">"GUDHI"</span>, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">printProgress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A view on the argument:</p>
<ul>
<li>As in <code>ripsFiltration</code> but without <code>maxdimension, maxscale, dist</code>.</li>
</ul>
<p>The output is in the same format as for <code>ripsFiltration</code>. Note however that the values itself are different.</p>
<p>This was expected. An advantage of the <span class="math inline">\(\alpha\)</span>-complexe is that it does not include simplicies of dimension higher than the dimension of the ambient space, here 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Afiltration<span class="sc">$</span>cmplx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1

[[2]]
[1] 2

[[3]]
[1] 3

[[4]]
[1] 4

[[5]]
[1] 4 3

[[6]]
[1] 3 2

[[7]]
[1] 4 2

[[8]]
[1] 4 3 2

[[9]]
[1] 3 1

[[10]]
[1] 4 1

[[11]]
[1] 4 3 1</code></pre>
</div>
</div>
<section id="using-the-persistence-diagram-1" class="level3">
<h3 class="anchored" data-anchor-id="using-the-persistence-diagram-1">Using the persistence diagram</h3>
<p>This is similar to what we did for the Rips complexes but without the arguments <code>maxscale, dist</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Adiag <span class="ot">&lt;-</span> <span class="fu">alphaComplexDiag</span>(<span class="at">X =</span> <span class="fu">cbind</span>(PPtoy<span class="sc">$</span>x, PPtoy<span class="sc">$</span>y), </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">maxdimension=</span><span class="dv">1</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">library =</span> <span class="fu">c</span>(<span class="st">"GUDHI"</span>), </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">location =</span> F, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">printProgress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Adiag</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$diagram
     dimension  Birth     Death
[1,]         0 0.0000       Inf
[2,]         0 0.0000 0.4225000
[3,]         0 0.0000 0.3125000
[4,]         0 0.0000 0.2500000
[5,]         1 0.3125 0.3906250
[6,]         1 0.4225 0.4958507</code></pre>
</div>
</div>
<p><strong>Warning:</strong> The output is not directly the diagram but a list containing the diagram.</p>
<p>Let’s plot it. Note that this is time, there is 2 loops. This looks more in adequation with the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Adiag<span class="sc">$</span>diagram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Adiag<span class="sc">$</span>diagram, <span class="at">barcode=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="on-the-argument-location" class="level2">
<h2 class="anchored" data-anchor-id="on-the-argument-location">On the argument <code>location</code></h2>
<p>We have used the argument <code>location=F</code>. What does it means?</p>
<ul>
<li>We may be interested in the precise location the point that kills or gives birth to a topological feature.</li>
<li>It is possible to find it if we use the library “PHAT” or “Dionysus”. Note that the TDA package requires “GUDHI” for some computation so both libraries needs to be put in input as follows.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>Adiag2 <span class="ot">&lt;-</span> <span class="fu">alphaComplexDiag</span>(<span class="at">X =</span> <span class="fu">cbind</span>(PPtoy<span class="sc">$</span>x, PPtoy<span class="sc">$</span>y), </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">maxdimension=</span><span class="dv">2</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">library =</span> <span class="fu">c</span>(<span class="st">"GUDHI"</span>, <span class="st">"Dionysus"</span>), </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">location =</span> T, </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">printProgress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Each point involved in the birth of a topological feature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Adiag2<span class="sc">$</span>birthLocation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,] -1.2  0.0
[2,]  1.0  0.0
[3,]  0.0 -0.5
[4,]  0.0  0.5
[5,]  1.0  0.0
[6,] -1.2  0.0</code></pre>
</div>
</div>
<p>Each point involved in the death of a topological feature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Adiag2<span class="sc">$</span>deathLocation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,] -1.2  0.0
[2,] -1.2  0.0
[3,]  1.0  0.0
[4,]  0.0 -0.5
[5,]  1.0  0.0
[6,] -1.2  0.0</code></pre>
</div>
</div>
<p><strong>Warning:</strong> the TDA package returns also an element called <code>cycleLocation</code> which represents the location of the cycles defining the topological feature. For example, for a loop it returns its border.<br>
<strong>This is, in several ways, dangerously wrong</strong></p>
<ul>
<li>This works quite well on the simple example in the documentaiton but not in a general setting.</li>
<li>It actually returns a representant of the loop, void… There is an infinity of representants and worst than that, the mathematical definition of a loop is not trivial.</li>
<li>We will not cover it in the lecture but I recommend the additional references given for this course and also the excellent list of tutorials given on the youtube channels: <a href="https://www.youtube.com/c/AppliedAlgebraicTopologyNetwork" class="uri">https://www.youtube.com/c/AppliedAlgebraicTopologyNetwork</a>.</li>
<li>In particular the tutorial of Teresa Heiss: <a href="https://youtu.be/a-va5BRs14k" class="uri">https://youtu.be/a-va5BRs14k</a></li>
</ul>
</section>
</section>
<section id="a-second-example-points-on-the-unit-circle" class="level1">
<h1>A second example – Points on the unit circle</h1>
<p>The TDA package includes a simple function for training purposes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>Circle1 <span class="ot">&lt;-</span> <span class="fu">circleUnif</span>(<span class="at">n=</span><span class="dv">60</span>, <span class="at">r=</span><span class="dv">1</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>Circle1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                x1          x2
 [1,] -0.999458716  0.03289796
 [2,]  0.902074100 -0.43158118
 [3,] -0.017186760  0.99985230
 [4,] -0.796020582  0.60526955
 [5,] -0.605256801 -0.79603028
 [6,]  0.870878299  0.49149872
 [7,] -0.328762353  0.94441268
 [8,] -0.999566470  0.02944268
 [9,] -0.532656995  0.84633122
[10,] -0.199369468  0.97992439
[11,]  0.987266034  0.15907790
[12,] -0.387242253  0.92197800
[13,] -0.999935737 -0.01133673
[14,] -0.562699411  0.82666158
[15,]  0.596392589  0.80269289
[16,]  0.548770906 -0.83597278
[17,]  0.990839510 -0.13504468
[18,]  0.878282006 -0.47814299
[19,] -0.778898733 -0.62714971
[20,] -0.526743597  0.85002422
[21,] -0.617295257  0.78673157
[22,]  0.331538819  0.94344158
[23,] -0.071813918 -0.99741805
[24,]  0.176011244  0.98438816
[25,]  0.546265486 -0.83761209
[26,] -0.629178606 -0.77726076
[27,]  0.329666422 -0.94409748
[28,]  0.993050378 -0.11769004
[29,] -0.659254608 -0.75191978
[30,]  0.989357205  0.14550712
[31,] -0.202474187 -0.97928760
[32,]  0.577507632 -0.81638529
[33,] -0.295534205  0.95533216
[34,]  0.790605439 -0.61232593
[35,] -0.865357733 -0.50115466
[36,]  0.826890832  0.56236247
[37,] -0.197546625 -0.98029349
[38,]  0.637730361 -0.77025969
[39,] -0.995754442  0.09204940
[40,]  0.995833333 -0.09119196
[41,]  0.360995855 -0.93256742
[42,] -0.551423914 -0.83422519
[43,]  0.969672723  0.24440706
[44,] -0.769145135 -0.63907414
[45,] -0.076006375 -0.99710733
[46,] -0.748277582 -0.66338576
[47,]  0.649431917 -0.76041974
[48,] -0.164547164 -0.98636922
[49,]  0.214354955 -0.97675583
[50,]  0.930361921 -0.36664246
[51,] -0.652015278 -0.75820583
[52,]  0.005898459  0.99998260
[53,]  0.860835838 -0.50888276
[54,]  0.655741073  0.75498586
[55,] -0.810509211  0.58572589
[56,] -0.993230534  0.11615983
[57,] -0.358396974 -0.93356928
[58,] -0.762914521  0.64649937
[59,] -0.803922674  0.59473383
[60,]  0.983642206 -0.18013331</code></pre>
</div>
</div>
<p>As you may see, this consists of 60 points on the unit circle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Circle1, <span class="at">asp=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="the-most-efficient-filtration-the-rips-complexes" class="level2">
<h2 class="anchored" data-anchor-id="the-most-efficient-filtration-the-rips-complexes">The most “efficient” filtration – The Rips complexes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Rfiltration <span class="ot">&lt;-</span> <span class="fu">ripsFiltration</span>(<span class="at">X=</span>Circle1, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">maxdimension=</span><span class="dv">2</span>, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">maxscale=</span><span class="dv">3</span>, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">dist =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">library =</span> <span class="st">"GUDHI"</span>, </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">printProgress =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Displaying the filtration is no more a solution as there is too many simplices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(Rfiltration<span class="sc">$</span>cmplx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 523685</code></pre>
</div>
</div>
<p>Thankfully, we do not need it to compute the persistence diagram. This time we see clearly one loop which is what we expect from an unit disc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>DiagRips <span class="ot">&lt;-</span> <span class="fu">ripsDiag</span>(<span class="at">X =</span> Circle1, <span class="at">maxdimension=</span><span class="dv">1</span>, <span class="at">maxscale=</span><span class="dv">1</span>,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="at">library =</span> <span class="st">"GUDHI"</span>, <span class="at">location =</span> F, <span class="at">printProgress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(DiagRips<span class="sc">$</span>diagram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="other-interesting-functions-of-the-tda-package" class="level1">
<h1>Other interesting functions of the TDA package</h1>
</section>
<section id="summary-statistics-computation" class="level1">
<h1>Summary statistics computation</h1>
<p>Let’s use the summary statistics defined for <span class="math inline">\(r &gt;0\)</span> by:<span class="math display">\[\int_0^{r} \sum_{i\leq d}\mathbf{1}_{(0,i) \in D}\mathrm{d}d\]</span>&nbsp;and</p>
<p><span class="math display">\[\frac{1}{\sqrt{\rho}|W|} \int_0^{r/\sqrt{\rho}} \sum_{i\leq d}\mathbf{1}_{(0,i) \in D}\mathrm{d}d.\]</span></p>
<p>We may compute it in R as follows. Let’s assume that <code>coords</code> represents a <span class="math inline">\(n\)</span> by <span class="math inline">\(2\)</span> matrix representing the <span class="math inline">\(x,y\)</span> coordinates of <span class="math inline">\(n\)</span> points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(PPtoy<span class="sc">$</span>x, PPtoy<span class="sc">$</span>y)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>diag <span class="ot">&lt;-</span> <span class="fu">alphaComplexDiag</span>(coords)<span class="sc">$</span>diagram <span class="co"># return the persistence diagram computed from the alpha complex </span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>diag_df <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">dimension =</span> diag[,<span class="dv">1</span>], </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">death =</span> diag[,<span class="dv">3</span>]) <span class="co"># Convert the diagram object </span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># to a data frame. This is easier to handle </span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(diag_df[diag_df<span class="sc">$</span>dimension <span class="sc">==</span> <span class="dv">0</span>, <span class="st">'death'</span>])  <span class="co"># extract the connected components (dimension 0) and sort them by increasing death time.  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2500 0.3125 0.4225    Inf</code></pre>
</div>
</div>
<p>The summary statistics is now easy to compute as it consists into as for any argument <span class="math inline">\(r\)</span> it consists into the sum of the death times until <span class="math inline">\(r\)</span>.</p>
<p>Let’s first gather the code above in a function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>tda0_raw <span class="ot">&lt;-</span> <span class="cf">function</span>(coords){    </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    diag <span class="ot">&lt;-</span> <span class="fu">alphaComplexDiag</span>(coords)<span class="sc">$</span>diagram</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    diag_df <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">dimension =</span> diag[,<span class="dv">1</span>], </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">death =</span> diag[,<span class="dv">3</span>])</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sort</span>(diag_df[diag_df<span class="sc">$</span>dimension <span class="sc">==</span> <span class="dv">0</span>, <span class="st">'death'</span>])  </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the following function:</p>
<ul>
<li><code>X</code> is the input point pattern as ppp object.</li>
<li><code>rc</code> correspond to the upper bound of the integral before being scaled.</li>
</ul>
<p>We also use the R function <code>findInterval</code> which provide us a nice shortcut to compute what we want. See the help function for more information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>tda0_scaled <span class="ot">&lt;-</span> <span class="cf">function</span>(X, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">rc =</span>  <span class="fl">0.3</span>){ </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    dt <span class="ot">&lt;-</span> <span class="fu">tda0_raw</span>(<span class="fu">cbind</span>(X<span class="sc">$</span>x, X<span class="sc">$</span>y)) <span class="co"># return the increasing list of death time. </span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    intens <span class="ot">&lt;-</span> X<span class="sc">$</span>n <span class="sc">/</span> <span class="fu">area.owin</span>(X<span class="sc">$</span>w) <span class="co"># Return the estimate intensity, equivalent to intensity(X)</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    tx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,rc<span class="sc">/</span><span class="fu">sqrt</span>(intens), <span class="at">length.out=</span><span class="fl">1e3</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">findInterval</span>(tx, dt)<span class="sc">/</span> (<span class="fu">sqrt</span>(intens) <span class="sc">*</span> <span class="fu">area.owin</span>(X<span class="sc">$</span>w))))</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="deviation-test" class="level1">
<h1>Deviation test</h1>
<p>We will test if an observed point process is a realisation of an homogeneous Poisson point process with intensity 2 on the window <span class="math inline">\([0,10]^2\)</span>.</p>
<p>This will be based on an application of the CLT presented in the slides. To that end, we need to estimate the mean and standard deviation of the summary statistics under the null hypothesis. To that end we will :</p>
<ul>
<li>Generate many point processes under the null hypothesis.</li>
<li>Calculate the chosen summary statistics for each of them.</li>
<li>Take the mean and standard deviation.</li>
<li>For the observed point pattern, compute the summary statistics.</li>
<li>Look how much it deviates from the theoretical normal distribution.</li>
<li>If it deviates by too much, we reject the null hypothesis.</li>
</ul>
<p>We will chose for this presentation the summary statistic: <span class="math display">\[\frac{1}{10\sqrt{2}} \int_0^{0.1/\sqrt{2}} \sum_{i\leq d}\mathbf{1}_{(0,i) \in D}\mathrm{d}d.\]</span></p>
<p>Note that this choice is arbitrary and the “best choice” is most likely dependent on your problem.</p>
<section id="simulations-under-the-null-hypothesis" class="level2">
<h2 class="anchored" data-anchor-id="simulations-under-the-null-hypothesis">Simulations under the null hypothesis</h2>
<p>Let’s simulate a lot of point processes under the null hypothesis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">35</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="co"># the more the better but be gentle with your laptop.</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>ppps <span class="ot">&lt;-</span> <span class="fu">rpoispp</span>(<span class="dv">2</span>, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">win =</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)), </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim =</span> nsim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now compute the value of the test statistic on each point process, then estimate the mean and standard deviation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>Statval <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ppps)) {</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    Statval[i] <span class="ot">&lt;-</span> <span class="fu">tda0_scaled</span>(ppps[[i]], </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">rc=</span> <span class="fl">0.1</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>Avstat <span class="ot">&lt;-</span> <span class="fu">mean</span>(Statval)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is the mean:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>Avstat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4840136</code></pre>
</div>
</div>
<p>And now the standard deviation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>sdstat <span class="ot">&lt;-</span> <span class="fu">sd</span>(Statval)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>sdstat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04281816</code></pre>
</div>
</div>
<p>A sanity check that our statistic follows a central limit theorem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>((Statval<span class="sc">-</span>Avstat)<span class="sc">/</span>sdstat, <span class="at">prob=</span>T, <span class="at">breaks=</span><span class="dv">25</span>) </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.01</span>), <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)), <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">4</span>) <span class="co"># Plot the density of a standard normal random variable.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This looks pretty good.</p>
</section>
<section id="assessing-type-i-and-ii-error" class="level2">
<h2 class="anchored" data-anchor-id="assessing-type-i-and-ii-error">Assessing type I and II error</h2>
<section id="estimate-the-type-i-error" class="level3">
<h3 class="anchored" data-anchor-id="estimate-the-type-i-error">Estimate the type I error</h3>
<p>We simulate some Poisson point processes according to the null hypothesis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">134</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>pptype1 <span class="ot">&lt;-</span> <span class="fu">rpoispp</span>(<span class="dv">2</span>, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">win =</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)), </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following function returns the estimated quantile of the test statistics for a given point process. Taking their average gives the estimated p-value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>pval_teststat <span class="ot">&lt;-</span> <span class="cf">function</span>(X){ </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    z_val <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">tda0_scaled</span>(X, <span class="at">rc=</span> <span class="fl">0.1</span>) <span class="sc">-</span> Avstat) <span class="sc">/</span> sdstat</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z_val))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Estimate the p-value from a sample of Poisson process</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">sapply</span>(pptype1, pval_teststat)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5116972</code></pre>
</div>
</div>
<p>Let’s see how many time we will reject the test at <span class="math inline">\(5\%\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(A<span class="sc">&lt;</span><span class="fl">0.05</span>) <span class="co"># Shoult return 5% approximately</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.044</code></pre>
</div>
</div>
<p>We find approximately the correct type I error.</p>
</section>
<section id="estimate-type-ii-error" class="level3">
<h3 class="anchored" data-anchor-id="estimate-type-ii-error">Estimate type II error</h3>
<p>To estimate type II error, we need to restrict ourselve. Let’s simulate matern cluster processes and see if our test rejects the assumption that they are Poisson.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">78</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>mctypeII <span class="ot">&lt;-</span> <span class="fu">rMatClust</span>(<span class="at">kappa=</span><span class="dv">2</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scale=</span>.<span class="dv">5</span>, </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mu=</span> <span class="dv">1</span>, </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">win =</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)), </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">nsim =</span> nsim) <span class="co"># this process should have intensity 2. Can you check it?  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Can you empirically checked that these point processes have intensity 2?</p>
<p>Let’s look at a plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mctypeII[[<span class="dv">1</span>]]<span class="sc">$</span>x, mctypeII[[<span class="dv">1</span>]]<span class="sc">$</span>y, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="at">pch=</span><span class="dv">20</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>,<span class="at">main=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The type II error when the type I error is <span class="math inline">\(5\%\)</span> is given by estimating how many time we reject the null hypothesis when it should be rejected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sapply</span>(mctypeII, pval_teststat)<span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.69</code></pre>
</div>
</div>
<p>Here we estimate the type II error to approximately <span class="math inline">\(69\%\)</span>.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>We have deviced a statistical test based on our central limit theorem.</li>
<li>Note that we could have used another statistics based on the loop for example.</li>
<li>For example, we could have used the accumulated persistence function based on the loop: <span class="math display">\[\mbox{APF}_k(m) = \sum_{p \in D} l_p \mathbf{1}_{\lbrace b_p \leq m \rbrace}.\]</span></li>
<li>It can be computed with the following code:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>APF1 <span class="ot">&lt;-</span> <span class="cf">function</span>(coords, r){</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    diag <span class="ot">&lt;-</span> <span class="fu">alphaComplexDiag</span>(coords)<span class="sc">$</span>diagram <span class="co"># compute the persistence diagram</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate the lifetime and meanage for all features</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    lifetime <span class="ot">=</span> diag[,<span class="dv">3</span>]<span class="sc">-</span>diag[,<span class="dv">2</span>]</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    meanage <span class="ot">=</span> (diag[,<span class="dv">3</span>]<span class="sc">+</span>diag[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Gather the lifetime and meanage in a dataframe, together with the corresponding dimension of the feature</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    diagrot_df <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">dimension =</span> diag[,<span class="dv">1</span>], </span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">lifetime =</span> lifetime,</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">meanage =</span> meanage )</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the 1 dimensional features</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    diagrot1_df <span class="ot">&lt;-</span>  diagrot_df[diagrot_df[,<span class="dv">1</span>]<span class="sc">==</span><span class="dv">1</span>,]                   </span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># In order for the function APF1 to apply on a vector of values for r, I use </span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sapply. For each element i in each r, I extract from the data frame </span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># diagrot1_df the row with meanage smaller than i </span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and take the value on the second column which is the lifetime. </span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># I then sum these values to obtain the APF evaluated at i. </span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(r, <span class="at">FUN=</span><span class="cf">function</span>(i){</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>        extracted_lifetime <span class="ot">&lt;-</span> diagrot1_df[diagrot1_df[,<span class="dv">3</span>]<span class="sc">&lt;</span>i,<span class="dv">2</span>]</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">sum</span>(extracted_lifetime))</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s see if it works on our toy example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.001</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m, <span class="fu">APF1</span>(<span class="at">coords=</span><span class="fu">cbind</span>(PPtoy<span class="sc">$</span>x, PPtoy<span class="sc">$</span>y), m), <span class="at">type=</span><span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Lecture1_Tutorial_TDA_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>